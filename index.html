<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°ˆæ¡ˆå·¥ç¨‹å¸«æˆ°é¬¥åŠ›è©•ä¼°ç³»çµ± | PM Power Assessment</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary-neon: #4a9eff;
            --secondary-neon: #64b5f6;
            --accent-neon: #82c4ff;
            --dark-bg: #1a1d29;
            --dark-surface: #252936;
            --dark-elevated: #2f3444;
            --text-primary: #e8eaf0;
            --text-secondary: #9ba3b4;
            --success: #52c41a;
            --warning: #faad14;
            --danger: #f5222d;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            padding-bottom: 20px;
        }

        /* èƒŒæ™¯å‹•ç•«ç¶²æ ¼ - æ‰‹æ©Ÿå„ªåŒ– */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, rgba(74, 158, 255, 0.03) 1px, transparent 1px),
                linear-gradient(rgba(74, 158, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: gridMove 20s linear infinite;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }

        /* æ¸›å°‘ç²’å­æ•¸é‡ä»¥æå‡æ‰‹æ©Ÿæ€§èƒ½ */
        .particle {
            position: fixed;
            width: 2px;
            height: 2px;
            background: var(--primary-neon);
            border-radius: 50%;
            pointer-events: none;
            animation: float 15s infinite;
            opacity: 0.2;
            box-shadow: 0 0 8px var(--primary-neon);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); opacity: 0; }
            10% { opacity: 0.2; }
            90% { opacity: 0.2; }
            100% { transform: translateY(-100vh) translateX(30px); opacity: 0; }
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
            position: relative;
            z-index: 1;
        }

        /* Header - æ‰‹æ©Ÿå„ªåŒ– */
        .header {
            text-align: center;
            padding: 20px 15px;
            background: linear-gradient(135deg, var(--dark-surface) 0%, var(--dark-elevated) 100%);
            border-radius: 15px;
            border: 2px solid var(--primary-neon);
            box-shadow: 0 0 30px rgba(74, 158, 255, 0.3);
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(74, 158, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.3rem, 5vw, 2.5rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-neon), var(--secondary-neon), var(--accent-neon));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(74, 158, 255, 0.5);
            margin-bottom: 8px;
            position: relative;
            line-height: 1.2;
        }

        .subtitle {
            font-family: 'Orbitron', sans-serif;
            color: var(--text-secondary);
            font-size: clamp(0.7rem, 2.5vw, 0.9rem);
            letter-spacing: 2px;
        }

        /* ç®¡ç†æŒ‰éˆ• - æ‰‹æ©Ÿå„ªåŒ– */
        .admin-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, var(--secondary-neon), var(--primary-neon));
            color: var(--dark-bg);
            border: none;
            padding: 10px 16px;
            border-radius: 20px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 0 15px rgba(100, 181, 246, 0.5);
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 1px;
        }

        .admin-btn:active {
            transform: scale(0.95);
            box-shadow: 0 0 20px rgba(100, 181, 246, 0.8);
        }

        /* ç™»å…¥é¢æ¿ - æ‰‹æ©Ÿå„ªåŒ– */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 26, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            padding: 20px;
        }

        .login-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .login-box {
            background: var(--dark-surface);
            padding: 30px 20px;
            border-radius: 15px;
            border: 2px solid var(--primary-neon);
            box-shadow: 0 0 40px rgba(74, 158, 255, 0.4);
            max-width: 400px;
            width: 100%;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .login-overlay.active .login-box {
            transform: scale(1);
        }

        .login-box h2 {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary-neon);
            margin-bottom: 25px;
            text-align: center;
            font-size: clamp(1.3rem, 4vw, 1.8rem);
        }

        .input-group {
            margin-bottom: 18px;
        }

        .input-group label {
            display: block;
            margin-bottom: 6px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-group input {
            width: 100%;
            padding: 12px 16px;
            background: var(--dark-bg);
            border: 2px solid var(--dark-elevated);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-neon);
            box-shadow: 0 0 12px rgba(74, 158, 255, 0.3);
        }

        .login-buttons {
            display: flex;
            gap: 10px;
            margin-top: 25px;
            flex-direction: column;
        }

        .btn {
            width: 100%;
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-neon), var(--secondary-neon));
            color: var(--dark-bg);
            box-shadow: 0 0 20px rgba(74, 158, 255, 0.4);
        }

        .btn-primary:active {
            transform: translateY(2px);
            box-shadow: 0 0 15px rgba(74, 158, 255, 0.6);
        }

        .btn-secondary {
            background: var(--dark-elevated);
            color: var(--text-primary);
            border: 2px solid var(--primary-neon);
        }

        .btn-secondary:active {
            background: var(--dark-bg);
        }

        /* ç®¡ç†é¢æ¿ - æ‰‹æ©Ÿå„ªåŒ– */
        .admin-panel {
            background: var(--dark-surface);
            padding: 20px 15px;
            border-radius: 15px;
            border: 2px solid var(--secondary-neon);
            box-shadow: 0 0 30px rgba(100, 181, 246, 0.3);
            margin-bottom: 20px;
            display: none;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-panel h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--secondary-neon);
            margin-bottom: 20px;
            font-size: clamp(1.1rem, 3.5vw, 1.5rem);
            text-align: center;
        }

        .admin-controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* è©•ä¼°å¡ç‰‡ - æ‰‹æ©Ÿå„ªåŒ– */
        .assessment-card {
            background: var(--dark-surface);
            padding: 20px 15px;
            border-radius: 15px;
            border: 2px solid var(--dark-elevated);
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .assessment-card:hover {
            border-color: var(--primary-neon);
            box-shadow: 0 0 25px rgba(74, 158, 255, 0.2);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 18px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .card-title {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1rem, 3.5vw, 1.3rem);
            color: var(--primary-neon);
        }

        .card-number {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(0.8rem, 2.5vw, 1rem);
            color: var(--text-secondary);
            background: var(--dark-bg);
            padding: 6px 12px;
            border-radius: 20px;
        }

        /* æŒ‡æ¨™é …ç›® - æ‰‹æ©Ÿå„ªåŒ– */
        .indicator-item {
            margin-bottom: 18px;
            padding: 15px;
            background: var(--dark-bg);
            border-radius: 10px;
            border-left: 3px solid var(--primary-neon);
        }

        .indicator-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 10px;
        }

        .indicator-name {
            font-size: clamp(0.9rem, 2.8vw, 1rem);
            color: var(--text-primary);
            flex: 1;
            line-height: 1.4;
        }

        .indicator-score {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(0.85rem, 2.5vw, 0.95rem);
            color: var(--accent-neon);
            white-space: nowrap;
            font-weight: 700;
        }

        /* æ»‘æ¡¿ - æ‰‹æ©Ÿå„ªåŒ– */
        .slider-container {
            position: relative;
            padding: 8px 0;
        }

        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: var(--dark-elevated);
            outline: none;
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-neon), var(--secondary-neon));
            cursor: pointer;
            box-shadow: 0 0 15px rgba(74, 158, 255, 0.6);
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb:active {
            width: 28px;
            height: 28px;
            box-shadow: 0 0 20px rgba(74, 158, 255, 0.8);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-neon), var(--secondary-neon));
            cursor: pointer;
            border: none;
            box-shadow: 0 0 15px rgba(74, 158, 255, 0.6);
        }

        /* è­‰ç…§é¸æ“‡ - æ‰‹æ©Ÿå„ªåŒ– */
        .cert-section {
            background: var(--dark-surface);
            padding: 20px 15px;
            border-radius: 15px;
            border: 2px solid var(--dark-elevated);
            margin-bottom: 15px;
        }

        .cert-section h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary-neon);
            margin-bottom: 15px;
            font-size: clamp(1rem, 3.5vw, 1.3rem);
        }

        .cert-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }

        .cert-item {
            background: var(--dark-bg);
            padding: 12px;
            border-radius: 10px;
            border: 2px solid var(--dark-elevated);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .cert-item:active {
            transform: scale(0.98);
        }

        .cert-item.selected {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(82, 196, 26, 0.1), rgba(82, 196, 26, 0.05));
            box-shadow: 0 0 15px rgba(82, 196, 26, 0.3);
        }

        .cert-name {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 6px;
            font-size: clamp(0.85rem, 2.5vw, 0.95rem);
        }

        .cert-bonus {
            font-family: 'Orbitron', sans-serif;
            color: var(--success);
            font-size: clamp(0.75rem, 2.2vw, 0.85rem);
        }

        /* è¨ˆç®—æŒ‰éˆ• - æ‰‹æ©Ÿå„ªåŒ– */
        .calculate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--success), #73d13d);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: clamp(1rem, 3vw, 1.2rem);
            cursor: pointer;
            box-shadow: 0 0 30px rgba(82, 196, 26, 0.4);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 20px 0;
        }

        .calculate-btn:active {
            transform: translateY(2px);
            box-shadow: 0 0 20px rgba(82, 196, 26, 0.6);
        }

        /* çµæœé¢æ¿ - æ‰‹æ©Ÿå„ªåŒ– */
        .results-panel {
            background: var(--dark-surface);
            padding: 20px 15px;
            border-radius: 15px;
            border: 2px solid var(--primary-neon);
            box-shadow: 0 0 40px rgba(74, 158, 255, 0.3);
            margin-bottom: 20px;
            display: none;
        }

        .results-panel.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .score-display {
            text-align: center;
            margin-bottom: 25px;
            padding: 25px 15px;
            background: linear-gradient(135deg, var(--dark-bg), var(--dark-elevated));
            border-radius: 15px;
            border: 2px solid var(--primary-neon);
        }

        .score-label {
            font-size: clamp(0.9rem, 2.8vw, 1rem);
            color: var(--text-secondary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .score-value {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(2.5rem, 10vw, 4rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-neon), var(--secondary-neon), var(--accent-neon));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            line-height: 1;
        }

        .level-badge {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(135deg, var(--warning), #ffc53d);
            color: var(--dark-bg);
            border-radius: 25px;
            font-weight: 700;
            font-size: clamp(0.9rem, 2.8vw, 1.1rem);
            margin-top: 10px;
        }

        /* åœ–è¡¨å®¹å™¨ - æ‰‹æ©Ÿå„ªåŒ– */
        .chart-container {
            position: relative;
            width: 100%;
            height: auto;
            min-height: 280px;
            max-height: 400px;
            margin: 20px 0;
            padding: 15px;
            background: var(--dark-bg);
            border-radius: 15px;
        }

        .chart-container canvas {
            max-width: 100%;
            height: auto !important;
        }

        /* è©³ç´°å ±å‘Š - æ‰‹æ©Ÿå„ªåŒ– */
        .details-section {
            margin-top: 20px;
        }

        .details-section h4 {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary-neon);
            margin-bottom: 15px;
            font-size: clamp(1rem, 3.2vw, 1.2rem);
        }

        .category-detail {
            background: var(--dark-bg);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary-neon);
        }

        .category-name {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: clamp(0.95rem, 2.8vw, 1.05rem);
        }

        .category-stats {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 8px;
            font-size: clamp(0.85rem, 2.5vw, 0.9rem);
            color: var(--text-secondary);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* å‹•ä½œæŒ‰éˆ•çµ„ - æ‰‹æ©Ÿå„ªåŒ– */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        .action-btn {
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: clamp(0.9rem, 2.8vw, 1rem);
        }

        .btn-download {
            background: linear-gradient(135deg, var(--primary-neon), var(--secondary-neon));
            color: var(--dark-bg);
            box-shadow: 0 0 20px rgba(74, 158, 255, 0.3);
        }

        .btn-download:active {
            transform: translateY(2px);
        }

        .btn-reset {
            background: var(--dark-elevated);
            color: var(--text-primary);
            border: 2px solid var(--danger);
        }

        .btn-reset:active {
            background: var(--dark-bg);
        }

        /* æç¤ºæ–‡å­— */
        .hint-text {
            color: var(--text-secondary);
            font-size: clamp(0.8rem, 2.3vw, 0.85rem);
            text-align: center;
            margin: 15px 0;
            line-height: 1.6;
        }

        /* åŠ è¼‰å‹•ç•« */
        .loading {
            text-align: center;
            padding: 30px;
            color: var(--primary-neon);
            font-family: 'Orbitron', sans-serif;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        /* éŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 480px) {
            .container {
                padding: 8px;
            }

            .header {
                padding: 15px 10px;
                margin-bottom: 12px;
            }

            .assessment-card {
                padding: 15px 12px;
            }

            .indicator-item {
                padding: 12px;
            }

            .cert-grid {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 10px;
            }

            .chart-container {
                min-height: 250px;
                padding: 10px;
            }
        }

        /* è¶…å°è¢å¹•å„ªåŒ– */
        @media (max-width: 360px) {
            .cert-grid {
                grid-template-columns: 1fr;
            }

            .slider::-webkit-slider-thumb {
                width: 20px;
                height: 20px;
            }
        }

        /* æ©«å±æ¨¡å¼å„ªåŒ– */
        @media (orientation: landscape) and (max-height: 500px) {
            .header {
                padding: 12px 10px;
            }

            .admin-btn {
                padding: 8px 12px;
                font-size: 0.65rem;
            }

            .chart-container {
                min-height: 200px;
                max-height: 300px;
            }
        }

        /* è§¸æ§å„ªåŒ– */
        @media (hover: none) and (pointer: coarse) {
            .btn, .action-btn, .cert-item, .admin-btn {
                min-height: 44px;
            }

            .slider::-webkit-slider-thumb {
                width: 28px;
                height: 28px;
            }

            .slider::-moz-range-thumb {
                width: 28px;
                height: 28px;
            }
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯ç²’å­ -->
    <div id="particles"></div>

    <!-- ç®¡ç†æŒ‰éˆ• -->
    <button class="admin-btn" onclick="toggleLogin()">ç®¡ç†</button>

    <!-- ç™»å…¥é¢æ¿ -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-box">
            <h2>ğŸ” ç®¡ç†å“¡ç™»å…¥</h2>
            <div class="input-group">
                <label>ä½¿ç”¨è€…åç¨±</label>
                <input type="text" id="username" placeholder="è«‹è¼¸å…¥ä½¿ç”¨è€…åç¨±">
            </div>
            <div class="input-group">
                <label>å¯†ç¢¼</label>
                <input type="password" id="password" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
            </div>
            <div class="login-buttons">
                <button class="btn btn-primary" onclick="login()">ç™»å…¥</button>
                <button class="btn btn-secondary" onclick="toggleLogin()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>PM POWER</h1>
            <p class="subtitle">PROJECT MANAGER ASSESSMENT SYSTEM</p>
        </div>

        <!-- ç®¡ç†é¢æ¿ -->
        <div class="admin-panel" id="adminPanel">
            <h3>âš™ï¸ ç®¡ç†æ§åˆ¶å°</h3>
            <div class="admin-controls">
                <button class="btn btn-primary" onclick="exportData()">ğŸ“¥ åŒ¯å‡ºæ‰€æœ‰è³‡æ–™</button>
                <button class="btn btn-secondary" onclick="viewStats()">ğŸ“Š æŸ¥çœ‹çµ±è¨ˆè³‡æ–™</button>
                <button class="btn btn-secondary" onclick="logout()">ğŸšª ç™»å‡º</button>
            </div>
        </div>

        <!-- å§“åè¼¸å…¥ -->
        <div class="assessment-card">
            <div class="card-header">
                <h3 class="card-title">ğŸ‘¤ è©•ä¼°å°è±¡</h3>
            </div>
            <div class="input-group">
                <label>å§“å</label>
                <input type="text" id="nameInput" placeholder="è«‹è¼¸å…¥å—è©•ä¼°è€…å§“å" style="font-size: 1rem;">
            </div>
        </div>

        <!-- èƒ½åŠ›è©•ä¼°å¡ç‰‡ -->
        <div class="assessment-card">
            <div class="card-header">
                <h3 class="card-title">ğŸ’¬ æºé€šåŠ›</h3>
                <span class="card-number">Category 1/6</span>
            </div>
            
            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">å®¢æˆ¶æºé€šèƒ½åŠ›</span>
                    <span class="indicator-score" id="score-1-1">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(1, 1, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">åœ˜éšŠæºé€šèˆ‡å”èª¿</span>
                    <span class="indicator-score" id="score-1-2">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(1, 2, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æœƒè­°ä¸»æŒèˆ‡ç°¡å ±</span>
                    <span class="indicator-score" id="score-1-3">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(1, 3, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">è¡çªç®¡ç†èƒ½åŠ›</span>
                    <span class="indicator-score" id="score-1-4">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(1, 4, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">è·¨éƒ¨é–€å”ä½œ</span>
                    <span class="indicator-score" id="score-1-5">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(1, 5, this.value)">
                </div>
            </div>
        </div>

        <div class="assessment-card">
            <div class="card-header">
                <h3 class="card-title">ğŸ”§ æŠ€è¡“åŠ›</h3>
                <span class="card-number">Category 2/6</span>
            </div>
            
            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">å½±éŸ³ç³»çµ±è¦åŠƒèˆ‡è¨­è¨ˆ</span>
                    <span class="indicator-score" id="score-2-1">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(2, 1, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">ç¶²è·¯æ¶æ§‹çŸ¥è­˜</span>
                    <span class="indicator-score" id="score-2-2">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(2, 2, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">ç¡¬é«”è¨­å‚™ç†Ÿæ‚‰åº¦</span>
                    <span class="indicator-score" id="score-2-3">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(2, 3, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">å•é¡Œè¨ºæ–·èˆ‡æ’é™¤</span>
                    <span class="indicator-score" id="score-2-4">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(2, 4, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æ–°æŠ€è¡“å­¸ç¿’èˆ‡æ‡‰ç”¨</span>
                    <span class="indicator-score" id="score-2-5">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(2, 5, this.value)">
                </div>
            </div>
        </div>

        <div class="assessment-card">
            <div class="card-header">
                <h3 class="card-title">âš¡ åŸ·è¡Œèˆ‡ç®¡æ§åŠ›</h3>
                <span class="card-number">Category 3/6</span>
            </div>
            
            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">é€²åº¦è¿½è¹¤èˆ‡æ§åˆ¶</span>
                    <span class="indicator-score" id="score-3-1">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(3, 1, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">å“è³ªç®¡ç†èˆ‡é©—æ”¶</span>
                    <span class="indicator-score" id="score-3-2">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(3, 2, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">è®Šæ›´ç®¡ç†èƒ½åŠ›</span>
                    <span class="indicator-score" id="score-3-3">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(3, 3, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">å±æ©Ÿè™•ç†èˆ‡æ‡‰è®Š</span>
                    <span class="indicator-score" id="score-3-4">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(3, 4, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æ–‡ä»¶ç®¡ç†èˆ‡ç´€éŒ„</span>
                    <span class="indicator-score" id="score-3-5">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(3, 5, this.value)">
                </div>
            </div>
        </div>

        <div class="assessment-card">
            <div class="card-header">
                <h3 class="card-title">ğŸ‘‘ é ˜å°åŠ›</h3>
                <span class="card-number">Category 4/6</span>
            </div>
            
            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">åœ˜éšŠæ¿€å‹µèˆ‡å£«æ°£ç®¡ç†</span>
                    <span class="indicator-score" id="score-4-1">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(4, 1, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æ±ºç­–èƒ½åŠ›</span>
                    <span class="indicator-score" id="score-4-2">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(4, 2, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">è³‡æºèª¿åº¦èƒ½åŠ›</span>
                    <span class="indicator-score" id="score-4-3">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(4, 3, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">è²¬ä»»æ‰¿æ“”èˆ‡ç•¶è²¬</span>
                    <span class="indicator-score" id="score-4-4">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(4, 4, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æˆæ¬Šèˆ‡åŸ¹é¤Šäººæ‰</span>
                    <span class="indicator-score" id="score-4-5">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(4, 5, this.value)">
                </div>
            </div>
        </div>

        <div class="assessment-card">
            <div class="card-header">
                <h3 class="card-title">ğŸ“‹ è¦åŠƒåŠ›</h3>
                <span class="card-number">Category 5/6</span>
            </div>
            
            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">éœ€æ±‚åˆ†æèˆ‡è¦åŠƒ</span>
                    <span class="indicator-score" id="score-5-1">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(5, 1, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æ™‚ç¨‹è¦åŠƒèˆ‡ç®¡ç†</span>
                    <span class="indicator-score" id="score-5-2">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(5, 2, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">é¢¨éšªè©•ä¼°èˆ‡ç®¡ç†</span>
                    <span class="indicator-score" id="score-5-3">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(5, 3, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">è³‡æºè¦åŠƒèˆ‡åˆ†é…</span>
                    <span class="indicator-score" id="score-5-4">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(5, 4, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æ‡‰è®Šè¨ˆç•«åˆ¶å®š</span>
                    <span class="indicator-score" id="score-5-5">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(5, 5, this.value)">
                </div>
            </div>
        </div>

        <div class="assessment-card">
            <div class="card-header">
                <h3 class="card-title">ğŸ’° å•†æ¥­èˆ‡æˆæœ¬æ„è­˜</h3>
                <span class="card-number">Category 6/6</span>
            </div>
            
            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">é ç®—ç·¨åˆ—èˆ‡æ§åˆ¶</span>
                    <span class="indicator-score" id="score-6-1">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(6, 1, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æˆæœ¬æ•ˆç›Šåˆ†æ</span>
                    <span class="indicator-score" id="score-6-2">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(6, 2, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">æ¡è³¼èˆ‡åˆç´„ç®¡ç†</span>
                    <span class="indicator-score" id="score-6-3">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(6, 3, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">åˆ©æ½¤èˆ‡åƒ¹å€¼å‰µé€ </span>
                    <span class="indicator-score" id="score-6-4">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(6, 4, this.value)">
                </div>
            </div>

            <div class="indicator-item">
                <div class="indicator-header">
                    <span class="indicator-name">å•†æ¥­è«‡åˆ¤èƒ½åŠ›</span>
                    <span class="indicator-score" id="score-6-5">5</span>
                </div>
                <div class="slider-container">
                    <input type="range" min="0" max="10" value="5" class="slider" 
                           oninput="updateScore(6, 5, this.value)">
                </div>
            </div>
        </div>

        <!-- è­‰ç…§é¸æ“‡ -->
        <div class="cert-section">
            <h3>ğŸ† å°ˆæ¥­è­‰ç…§åŠ åˆ†</h3>
            <p class="hint-text">é»é¸å·²å–å¾—çš„è­‰ç…§ï¼Œç³»çµ±å°‡è‡ªå‹•åŠ åˆ†</p>
            <div class="cert-grid" id="certGrid"></div>
        </div>

        <!-- è¨ˆç®—æŒ‰éˆ• -->
        <button class="calculate-btn" onclick="calculateScore()">ğŸš€ è¨ˆç®—æˆ‘çš„æˆ°é¬¥åŠ›</button>

        <!-- çµæœé¢æ¿ -->
        <div class="results-panel" id="resultsPanel">
            <div class="score-display">
                <div class="score-label">ç¸½æˆ°é¬¥åŠ›</div>
                <div class="score-value" id="totalScore">0</div>
                <div class="level-badge" id="levelBadge">æœªè©•ä¼°</div>
            </div>

            <div class="chart-container">
                <canvas id="radarChart"></canvas>
            </div>

            <div class="details-section">
                <h4>ğŸ“Š èƒ½åŠ›åˆ†æ</h4>
                <div id="categoryDetails"></div>
            </div>

            <div class="action-buttons">
                <button class="action-btn btn-download" onclick="downloadReport()">
                    ğŸ“¥ ä¸‹è¼‰å®Œæ•´å ±å‘Š
                </button>
                <button class="action-btn btn-reset" onclick="resetAssessment()">
                    ğŸ”„ é‡æ–°è©•ä¼°
                </button>
            </div>
        </div>
    </div>

    <script>
        // æ•¸æ“šçµæ§‹
        const categories = [
            { name: 'æºé€šåŠ›', indicators: 5, weight: 0.18 },
            { name: 'æŠ€è¡“åŠ›', indicators: 5, weight: 0.16 },
            { name: 'åŸ·è¡Œèˆ‡ç®¡æ§åŠ›', indicators: 5, weight: 0.18 },
            { name: 'é ˜å°åŠ›', indicators: 5, weight: 0.16 },
            { name: 'è¦åŠƒåŠ›', indicators: 5, weight: 0.16 },
            { name: 'å•†æ¥­èˆ‡æˆæœ¬æ„è­˜', indicators: 5, weight: 0.16 }
        ];

        const certifications = [
            { name: 'PMP', bonus: 10 },
            { name: 'CAPM', bonus: 5 },
            { name: 'PMI-ACP', bonus: 8 },
            { name: 'PRINCE2', bonus: 7 },
            { name: 'Scrum Master', bonus: 6 },
            { name: 'CCNA', bonus: 6 },
            { name: 'CCNP', bonus: 8 },
            { name: 'CTS', bonus: 8 },
            { name: 'CTS-D', bonus: 10 },
            { name: 'CTS-I', bonus: 9 },
            { name: 'Dante', bonus: 7 },
            { name: 'Crestron', bonus: 8 },
            { name: 'Extron', bonus: 7 },
            { name: 'CompTIA A+', bonus: 4 },
            { name: 'CompTIA Network+', bonus: 5 },
            { name: 'CompTIA Security+', bonus: 5 },
            { name: 'ITIL', bonus: 6 }
        ];

        let scores = {};
        let selectedCerts = new Set();
        let isLoggedIn = false;
        let radarChart = null;

        // åˆå§‹åŒ–
        function init() {
            // åˆå§‹åŒ–åˆ†æ•¸
            for (let i = 1; i <= 6; i++) {
                for (let j = 1; j <= 5; j++) {
                    scores[`${i}-${j}`] = 5;
                }
            }

            // æ¸²æŸ“è­‰ç…§é¸é …
            renderCertifications();
            
            // å‰µå»ºèƒŒæ™¯ç²’å­ï¼ˆæ¸›å°‘æ•¸é‡ä»¥å„ªåŒ–æ‰‹æ©Ÿæ€§èƒ½ï¼‰
            createParticles(5);

            // æª¢æŸ¥ç™»å…¥ç‹€æ…‹
            checkLoginStatus();
        }

        // å‰µå»ºèƒŒæ™¯ç²’å­
        function createParticles(count) {
            const container = document.getElementById('particles');
            for (let i = 0; i < count; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        // æ›´æ–°åˆ†æ•¸
        function updateScore(category, indicator, value) {
            const key = `${category}-${indicator}`;
            scores[key] = parseInt(value);
            document.getElementById(`score-${key}`).textContent = value;
        }

        // æ¸²æŸ“è­‰ç…§é¸é …
        function renderCertifications() {
            const grid = document.getElementById('certGrid');
            certifications.forEach((cert, index) => {
                const item = document.createElement('div');
                item.className = 'cert-item';
                item.innerHTML = `
                    <div class="cert-name">${cert.name}</div>
                    <div class="cert-bonus">+${cert.bonus}åˆ†</div>
                `;
                item.onclick = () => toggleCert(index, item);
                grid.appendChild(item);
            });
        }

        // åˆ‡æ›è­‰ç…§é¸æ“‡
        function toggleCert(index, element) {
            if (selectedCerts.has(index)) {
                selectedCerts.delete(index);
                element.classList.remove('selected');
            } else {
                selectedCerts.add(index);
                element.classList.add('selected');
            }
        }

        // è¨ˆç®—åˆ†æ•¸
        function calculateScore() {
            const name = document.getElementById('nameInput').value.trim();
            if (!name) {
                alert('è«‹è¼¸å…¥å§“åï¼');
                return;
            }

            // è¨ˆç®—å„é¡åˆ¥åˆ†æ•¸
            let totalScore = 0;
            const categoryScores = [];

            categories.forEach((cat, catIndex) => {
                let catScore = 0;
                for (let i = 1; i <= cat.indicators; i++) {
                    catScore += scores[`${catIndex + 1}-${i}`];
                }
                const avgScore = catScore / cat.indicators;
                const weightedScore = avgScore * cat.weight * 10;
                totalScore += weightedScore;
                
                categoryScores.push({
                    name: cat.name,
                    score: avgScore,
                    percentage: (avgScore / 10 * 100).toFixed(1),
                    weighted: weightedScore.toFixed(2)
                });
            });

            // åŠ å…¥è­‰ç…§åŠ åˆ†
            let certBonus = 0;
            selectedCerts.forEach(index => {
                certBonus += certifications[index].bonus;
            });

            const finalScore = Math.min(100, totalScore + certBonus);

            // é¡¯ç¤ºçµæœ
            displayResults(name, finalScore, categoryScores, certBonus);

            // ä¿å­˜è©•ä¼°è¨˜éŒ„
            saveAssessment(name, finalScore, categoryScores, certBonus);

            // æ»¾å‹•åˆ°çµæœ
            document.getElementById('resultsPanel').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }

        // é¡¯ç¤ºçµæœ
        function displayResults(name, score, categoryScores, certBonus) {
            // æ›´æ–°åˆ†æ•¸é¡¯ç¤º
            document.getElementById('totalScore').textContent = score.toFixed(2);
            
            // åˆ¤å®šç­‰ç´š
            const level = getLevel(score);
            const badge = document.getElementById('levelBadge');
            badge.textContent = level;
            badge.style.background = getLevelColor(level);

            // ç¹ªè£½é›·é”åœ–
            drawRadarChart(categoryScores);

            // é¡¯ç¤ºè©³ç´°åˆ†æ
            displayCategoryDetails(categoryScores, certBonus);

            // é¡¯ç¤ºçµæœé¢æ¿
            document.getElementById('resultsPanel').classList.add('active');
        }

        // åˆ¤å®šç­‰ç´š
        function getLevel(score) {
            if (score >= 90) return 'Sç´š - å‚³å¥‡PM';
            if (score >= 85) return 'A+ç´š - å“è¶ŠPM';
            if (score >= 80) return 'Aç´š - å„ªç§€PM';
            if (score >= 75) return 'B+ç´š - è‰¯å¥½PM';
            if (score >= 70) return 'Bç´š - ç¨±è·PM';
            if (score >= 65) return 'C+ç´š - åˆæ ¼PM';
            if (score >= 60) return 'Cç´š - åŸºç¤PM';
            if (score >= 55) return 'Dç´š - æˆé•·ä¸­';
            if (score >= 50) return 'Eç´š - å…¥é–€è€…';
            return 'Fç´š - æ–°æ‰‹';
        }

        // ç²å–ç­‰ç´šé¡è‰²
        function getLevelColor(level) {
            if (level.startsWith('S')) return 'linear-gradient(135deg, #f5222d, #ff4d4f)';
            if (level.startsWith('A')) return 'linear-gradient(135deg, #faad14, #ffc53d)';
            if (level.startsWith('B')) return 'linear-gradient(135deg, #52c41a, #73d13d)';
            if (level.startsWith('C')) return 'linear-gradient(135deg, #1890ff, #40a9ff)';
            return 'linear-gradient(135deg, #8c8c8c, #bfbfbf)';
        }

        // ç¹ªè£½é›·é”åœ–
        function drawRadarChart(categoryScores) {
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            if (radarChart) {
                radarChart.destroy();
            }

            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: categoryScores.map(c => c.name),
                    datasets: [{
                        label: 'èƒ½åŠ›åˆ†æ•¸',
                        data: categoryScores.map(c => c.score),
                        backgroundColor: 'rgba(74, 158, 255, 0.2)',
                        borderColor: '#4a9eff',
                        borderWidth: 2,
                        pointBackgroundColor: '#4a9eff',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#4a9eff',
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 10,
                            min: 0,
                            ticks: {
                                stepSize: 2,
                                color: '#9ba3b4',
                                backdropColor: 'transparent',
                                font: {
                                    size: window.innerWidth < 480 ? 10 : 12
                                }
                            },
                            grid: {
                                color: 'rgba(74, 158, 255, 0.1)'
                            },
                            pointLabels: {
                                color: '#e8eaf0',
                                font: {
                                    size: window.innerWidth < 480 ? 11 : 13,
                                    weight: '500'
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // é¡¯ç¤ºé¡åˆ¥è©³æƒ…
        function displayCategoryDetails(categoryScores, certBonus) {
            const container = document.getElementById('categoryDetails');
            container.innerHTML = '';

            categoryScores.forEach(cat => {
                const detail = document.createElement('div');
                detail.className = 'category-detail';
                detail.innerHTML = `
                    <div class="category-name">${cat.name}</div>
                    <div class="category-stats">
                        <span class="stat-item">ğŸ’¯ å¹³å‡åˆ†æ•¸: ${cat.score.toFixed(2)}</span>
                        <span class="stat-item">ğŸ“Š é”æˆç‡: ${cat.percentage}%</span>
                        <span class="stat-item">âš–ï¸ åŠ æ¬Šåˆ†æ•¸: ${cat.weighted}</span>
                    </div>
                `;
                container.appendChild(detail);
            });

            if (certBonus > 0) {
                const certDetail = document.createElement('div');
                certDetail.className = 'category-detail';
                certDetail.style.borderLeftColor = 'var(--success)';
                certDetail.innerHTML = `
                    <div class="category-name">ğŸ† è­‰ç…§åŠ åˆ†</div>
                    <div class="category-stats">
                        <span class="stat-item">å·²å–å¾—è­‰ç…§: ${selectedCerts.size} å¼µ</span>
                        <span class="stat-item">ç¸½åŠ åˆ†: +${certBonus} åˆ†</span>
                    </div>
                `;
                container.appendChild(certDetail);
            }
        }

        // ä¸‹è¼‰å ±å‘Š
        function downloadReport() {
            const name = document.getElementById('nameInput').value.trim();
            const score = parseFloat(document.getElementById('totalScore').textContent);
            const level = document.getElementById('levelBadge').textContent;

            // ç”Ÿæˆå ±å‘Šæ–‡å­—
            let report = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          PM POWER ASSESSMENT REPORT                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€åŸºæœ¬è³‡è¨Šã€‘
è©•ä¼°å°è±¡ï¼š${name}
è©•ä¼°æ—¥æœŸï¼š${new Date().toLocaleDateString('zh-TW')}
ç¸½æˆ°é¬¥åŠ›ï¼š${score.toFixed(2)} / 100
è©•ä¼°ç­‰ç´šï¼š${level}

ã€å…­å¤§èƒ½åŠ›åˆ†æã€‘
`;

            categories.forEach((cat, index) => {
                let catScore = 0;
                for (let i = 1; i <= 5; i++) {
                    catScore += scores[`${index + 1}-${i}`];
                }
                const avg = catScore / 5;
                const percentage = (avg / 10 * 100).toFixed(1);
                report += `${cat.name}: ${avg.toFixed(2)}/10 (${percentage}%)\n`;
            });

            if (selectedCerts.size > 0) {
                report += `\nã€è­‰ç…§åŠ åˆ†ã€‘\n`;
                selectedCerts.forEach(index => {
                    const cert = certifications[index];
                    report += `âœ“ ${cert.name} (+${cert.bonus}åˆ†)\n`;
                });
            }

            report += `
\nã€è©•ä¼°å»ºè­°ã€‘
æŒçºŒç²¾é€²å°ˆæ¥­èƒ½åŠ›ï¼Œå®šæœŸåƒèˆ‡è¨“ç·´èˆ‡èªè­‰
å»ºç«‹å€‹äººå°ˆæ¡ˆç®¡ç†çŸ¥è­˜åº«
ç©æ¥µåƒèˆ‡å°ˆæ¡ˆç®¡ç†ç¤¾ç¾¤äº¤æµ

å ±å‘Šç”¢ç”Ÿæ™‚é–“ï¼š${new Date().toLocaleString('zh-TW')}
è©•ä¼°ç³»çµ±ç‰ˆæœ¬ï¼šMobile v1.0
            `;

            // ä¸‹è¼‰æª”æ¡ˆ
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${name}_PMæˆ°é¬¥åŠ›è©•ä¼°_${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // é‡ç½®è©•ä¼°
        function resetAssessment() {
            if (confirm('ç¢ºå®šè¦é‡æ–°è©•ä¼°å—ï¼Ÿæ‰€æœ‰è³‡æ–™å°‡è¢«æ¸…é™¤ã€‚')) {
                // é‡ç½®æ‰€æœ‰åˆ†æ•¸
                for (let key in scores) {
                    scores[key] = 5;
                }

                // é‡ç½®æ‰€æœ‰æ»‘æ¡¿
                document.querySelectorAll('.slider').forEach(slider => {
                    slider.value = 5;
                });

                // é‡ç½®åˆ†æ•¸é¡¯ç¤º
                document.querySelectorAll('.indicator-score').forEach(score => {
                    score.textContent = '5';
                });

                // æ¸…é™¤è­‰ç…§é¸æ“‡
                selectedCerts.clear();
                document.querySelectorAll('.cert-item').forEach(item => {
                    item.classList.remove('selected');
                });

                // æ¸…é™¤å§“å
                document.getElementById('nameInput').value = '';

                // éš±è—çµæœé¢æ¿
                document.getElementById('resultsPanel').classList.remove('active');

                // æ»¾å‹•åˆ°é ‚éƒ¨
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // ç™»å…¥ç›¸é—œå‡½æ•¸
        function toggleLogin() {
            const overlay = document.getElementById('loginOverlay');
            overlay.classList.toggle('active');
        }

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === 'admin' && password === 'pm2024') {
                isLoggedIn = true;
                localStorage.setItem('pmAdminLogin', 'true');
                document.getElementById('adminPanel').classList.add('active');
                toggleLogin();
                alert('ç™»å…¥æˆåŠŸï¼');
            } else {
                alert('å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼');
            }
        }

        function logout() {
            isLoggedIn = false;
            localStorage.removeItem('pmAdminLogin');
            document.getElementById('adminPanel').classList.remove('active');
            alert('å·²ç™»å‡ºï¼');
        }

        function checkLoginStatus() {
            if (localStorage.getItem('pmAdminLogin') === 'true') {
                isLoggedIn = true;
                document.getElementById('adminPanel').classList.add('active');
            }
        }

        function exportData() {
            const data = localStorage.getItem('pmAssessments') || '[]';
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `PMè©•ä¼°è³‡æ–™_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function viewStats() {
            const assessments = JSON.parse(localStorage.getItem('pmAssessments') || '[]');
            if (assessments.length === 0) {
                alert('ç›®å‰æ²’æœ‰è©•ä¼°è¨˜éŒ„');
                return;
            }

            const avgScore = assessments.reduce((sum, a) => sum + a.score, 0) / assessments.length;
            alert(`çµ±è¨ˆè³‡æ–™ï¼š\nç¸½è©•ä¼°äººæ•¸ï¼š${assessments.length}\nå¹³å‡æˆ°é¬¥åŠ›ï¼š${avgScore.toFixed(2)}`);
        }

        function saveAssessment(name, score, categories, certBonus) {
            const assessments = JSON.parse(localStorage.getItem('pmAssessments') || '[]');
            assessments.push({
                name,
                score,
                categories,
                certBonus,
                date: new Date().toISOString()
            });
            localStorage.setItem('pmAssessments', JSON.stringify(assessments));
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        window.onload = init;
    </script>
</body>
</html>
